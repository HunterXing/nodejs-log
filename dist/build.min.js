"use strict";function e(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function r(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?e(Object(o),!0).forEach((function(e){i(r,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}))}return r}function t(e){var r=function(e,r){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,r||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:r+""}function o(e,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,t(i.key),i)}}function i(e,r,o){return(r=t(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}var n,l=require("fs"),c=require("path"),a=require("dayjs"),s=function(e){return e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=2]="info",e[e.verbose=3]="verbose",e[e.debug=4]="debug",e[e.silly=5]="silly",e}(s||{}),u=null===(n=Object.values(s))||void 0===n?void 0:n.splice(0,6),f=function(){return e=function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.logDir=r.logDir||"./logs",this.logFilePath=c.join(this.logDir,r.logName),this.recordLevel=r.recordLevel||[s.error],this.consoleOutput=Boolean(r.console),this.mode=r.mode||v.mode,this.reserveTime=r.reserveTime||v.reserveTime,l.existsSync(this.logDir)||l.mkdirSync(this.logDir,{recursive:!0})},(r=[{key:"log",value:function(e,r){var t=this,o="";e===s.error&&(o=(new Error).stack+"\n");var i="".concat(a().format("YYYY-MM-DD HH:mm:ss.SSS")," [").concat(s[e],"] ").concat(r,"\n").concat(o);if(this.recordLevel.includes(e)){var n=a().startOf("day");if([0,2].includes(this.mode)){var l="".concat(this.logFilePath,".").concat(n.format("YYYY-MM-DD"),".txt");this.addLog(l,i)}[1,2].includes(this.mode)&&u.forEach((function(r){if(e===s[r]){var o="".concat(t.logFilePath,".").concat(r,".").concat(n.format("YYYY-MM-DD"),".txt");t.addLog(o,i)}}))}this.consoleOutput&&console.log(i)}},{key:"addLog",value:function(e,r){this.autoDeleteLog(),l.existsSync(e)?l.appendFileSync(e,r):l.writeFileSync(e,r)}},{key:"autoDeleteLog",value:function(){var e=this;0!==this.reserveTime&&l.readdirSync(this.logDir).forEach((function(r){var t=c.join(e.logDir,r),o=l.statSync(t),i=a(o.birthtime).valueOf(),n=a().valueOf();o.isFile()&&i+1e3*e.reserveTime<n&&l.unlinkSync(t)}))}},{key:"error",value:function(e){this.log(s.error,e)}},{key:"warn",value:function(e){this.log(s.warn,e)}},{key:"info",value:function(e){this.log(s.info,e)}},{key:"verbose",value:function(e){this.log(s.verbose,e)}},{key:"debug",value:function(e){this.log(s.debug,e)}},{key:"silly",value:function(e){this.log(s.silly,e)}}])&&o(e.prototype,r),t&&o(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,t}(),v={mode:0,logName:"log",recordLevel:[s.error,s.warn,s.info,s.verbose,s.debug,s.silly],logDir:"./logs",reserveTime:31536e3,console:!0};exports.LogLevel=s,exports.Logger=f,exports.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r(r({},v),e);return new f(t)},exports.defaultOptions=v;
